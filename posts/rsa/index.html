<!DOCTYPE html>
<html lang="en-gb"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">RSA加密算法（一） | a39&#39;s blog</title>
<meta property="og:title" content="RSA加密算法（一） | a39&#39;s blog" />
<meta name="twitter:title" content="RSA加密算法（一） | a39&#39;s blog" />
<meta itemprop="name" content="RSA加密算法（一） | a39&#39;s blog" />
<meta name="application-name" content="RSA加密算法（一） | a39&#39;s blog" />
<meta property="og:site_name" content="Awesome hugo blog" />

<meta name="description" content="RSA加密算法">
<meta itemprop="description" content="RSA加密算法" />
<meta property="og:description" content="RSA加密算法" />
<meta name="twitter:description" content="RSA加密算法" />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />

  <link rel="alternate" hreflang="en-gb" href="http://localhost:1313/posts/rsa/" title="English" />



  <meta itemprop="image" content="http://localhost:1313/" />
  <meta property="og:image" content="http://localhost:1313/" />
  <meta name="twitter:image" content="http://localhost:1313/" />
  <meta name="twitter:image:src" content="http://localhost:1313/" />




    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2022-07-29T00:00:00Z />
    <meta property="article:published_time" content=2022-07-29T00:00:00Z />

    
    <meta property="og:article:author" content="A39" />
    <meta property="article:author" content="A39" />
    <meta name="author" content="A39" />
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "RSA加密算法（一）",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2022-07-29",
        "description": "RSA加密算法",
        "wordCount":  292 ,
        "mainEntityOfPage": "True",
        "dateModified": "2022-07-29",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "a39\u0027s blog"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.124.1">

    

    <link rel="canonical" href="http://localhost:1313/posts/rsa/">
    <link href="/style.min.4f425fac94f4dc104bcea9917ddb61e42c44aacaff8ba84ffc9040717f5b9d72.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon.ico">
    <link rel="mask-icon" href="/icons/favicon.ico">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" crossorigin="anonymous" />


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    integrity="sha512-LQNxIMR5rXv7o+b1l8+N1EZMfhG7iFZ9HhnbJkTp4zjNr5Wvst75AqUeFDxeRUa7l5vEDyUiAip//r+EFLLCyA=="
    crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous" onload="renderMathInElement(document.body, {
      delimiters: [
        {left: '$$', right: '$$', display: true},
        {left: '$', right: '$', display: false}
      ]
    });"></script>
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/friends/">
                        Friends
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">RSA加密算法（一）</h1>
                
                
                <div class="post-meta">
                    <time datetime="2022-07-29T00:00:00&#43;00:00" itemprop="datePublished"> 29 Jul 2022 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b>Table of Contents</b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a></li>
    <li><a href="#历史杂谈">历史杂谈</a></li>
    <li><a href="#数学基础">数学基础</a>
      <ul>
        <li><a href="#互质">互质</a></li>
        <li><a href="#欧拉函数">欧拉函数</a>
          <ul>
            <li><a href="#第一种情况">第一种情况</a></li>
            <li><a href="#第二种情况">第二种情况</a></li>
            <li><a href="#第三种情况">第三种情况</a></li>
            <li><a href="#第四种情况">第四种情况</a></li>
            <li><a href="#第五种情况">第五种情况</a></li>
          </ul>
        </li>
        <li><a href="#欧拉定理">欧拉定理</a></li>
        <li><a href="#费马小定理">费马小定理</a></li>
        <li><a href="#模反元素">模反元素</a></li>
      </ul>
    </li>
    <li><a href="#rsa算法">RSA算法</a>
      <ul>
        <li><a href="#参数">参数</a></li>
        <li><a href="#加密解密">加密&amp;解密</a>
          <ul>
            <li><a href="#使用公钥ne加密">使用公钥（n,e）加密</a></li>
            <li><a href="#使用私钥nd解密">使用私钥（n,d）解密</a></li>
          </ul>
        </li>
        <li><a href="#安全性">安全性</a></li>
      </ul>
    </li>
    <li><a href="#后记">后记</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <ul>
<li><em>本文大量使用$\LaTeX$公式，建议刷新一次使渲染更新后食用</em></li>
</ul>
<h2 id="前言">前言</h2>
<p>内行吹得天花乱坠、外行死活看不懂的深奥数论和其他近现代数学分支到底有什么用处？近现代数学取得的成果到底有何现实意义？数学家到底在思考什么、研究什么？这几个问题困扰了我这个数学废物很久很久。直到如今成为一名网安小白，接触了密码学之后，这个疑惑才终于散去几分。希望看了这篇关于 RSA 加密算法的介绍之后，你也能得到些许明悟。</p>
<h2 id="历史杂谈">历史杂谈</h2>
<p>1976 年以前，人类所有的加密算法都使用同一种模式</p>
<ol>
<li>发送方选择一种加密规则对信息进行加密</li>
<li>接收方使用同一种规则对信息进行解密</li>
</ol>
<p>由于加密和解密使用同一种规则，因此这种加密算法称为“对称加密算法”。</p>
<p>不难看出，对称加密算法最大的弱点在于，发送和接受双方必须事先约定加密规则，此时要想保密地传递和保存密钥变得十分困难。随着计算机技术的快速发展，这个问题变得更加严峻。最著名的例子就是二战时期纳粹德国的密码系统恩尼格玛被计算机科学之父艾伦·图灵设计的机器破解。</p>
<p>1976 年，两位美国计算机学家 Whitfield Diffie 和 Martin Hellman，提出了一种崭新构思，可以在不直接传递密钥的情况下，完成解密。这被称为“Diffie-Hellman 密钥交换算法”。这个算法启发了其他科学家。人们认识到，加密和解密可以使用不同的规则，只要这两种规则之间存在某种对应关系即可，这样就避免了直接传递密钥。</p>
<ol>
<li>接收方生成公钥和私钥两把密钥，其中公钥是公开的，而私钥是保密的</li>
<li>发送方获取公开的公钥，使用它对信息进行加密</li>
<li>接收方使用保密的私钥对信息进行解密</li>
</ol>
<p>公钥加密的信息只能通过私钥解得，只要私钥不泄露，通信就是安全的。</p>
<p>这种加密算法称为“非对称加密算法”。</p>
<p>1977 年，三位数学家 Rivest、Shamir 和 Adleman（封面图）设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字命名，叫做 RSA 算法。直到现在，RSA 算法依旧是最广为使用的非对称加密算法。毫不夸张地说，只要有计算机网络的地方，就有 RSA 算法。</p>
<p>RSA算法非常可靠，密钥越长，它就越难破解。根据已经披露的文献，目前被破解的最长 RSA 密钥是 768 个二进制位。也就是说，长度超过 768 位的密钥，还无法破解（至少没人公开宣布）。因此可以认为，1024 位的 RSA 密钥基本安全，2048位的密钥极其安全。</p>
<h2 id="数学基础">数学基础</h2>
<h3 id="互质">互质</h3>
<p>若两个正整数除了 1 以外没有其他公因子，则我们称这两个数是互质关系（coprime）。注意，构成互质关系的两个数不一定是质数。</p>
<h3 id="欧拉函数">欧拉函数</h3>
<p>先来引入一个问题：</p>
<blockquote>
<p>任意给定正整数n，则在小于等于n的正整数之中，有多少个与n构成互质关系？</p>
</blockquote>
<p>欧拉函数可以用来解决则个问题。</p>
<p>约定用$\phi(n)$来表示欧拉函数。欧拉函数本身并不复杂，下面来一步步讨论。</p>
<h4 id="第一种情况">第一种情况</h4>
<p>若 n=1，显然$\phi(1)=1。$</p>
<h4 id="第二种情况">第二种情况</h4>
<p>若 n 是质数，则$\phi(n)=n-1$。因为质数与小于它的每个数都构成互质关系。</p>
<h4 id="第三种情况">第三种情况</h4>
<p>若 n 是质数 p 的 k 次方，即$n=p^k$，则</p>
<p>$$
\phi(p^k)=p^k-p^{k-1}=p^k(1-\frac{1}{p})
$$</p>
<p>这是因为一个数只有当它不包含 p 时才能与 n 互质；而小于 n 且包含 p 的数有$1\times p、2\times p、3\times p、\ldots、(n-1)\times p$共$p^{k-1}$个,将它们剔除后剩下的就是与 n 互质的数。</p>
<h4 id="第四种情况">第四种情况</h4>
<p>若 n 可以分解成两质数的乘积，即$n=p_1\times p_2$，则
$$
\phi(n)=\phi(p_1p_2)=\phi(p_1)\phi(p_2)
$$
这条式子的证明需要用到著名的“中国剩余定理”,无奈限于本人水平限制，在这里就暂不展开了。</p>
<h4 id="第五种情况">第五种情况</h4>
<p>因为任意一个大于 1 的正整数 n 都可以分解成一系列质数的乘积
$$
n=p_1^{k1}p_2^{k2}\ldots p_r^{kr}
$$
又根据第四种情况，我们可以得到
$$
\phi(n)=\phi(p_1^{k1})\phi(p_2^{k2})\ldots \phi(p_r^{kr})=p_1^{k1}p_2^{k2}\ldots p_r^{kr}(1-\frac{1}{p_1})(1-\frac{1}{p_2})\ldots(1-\frac{1}{p_r})
$$
化简得
$$
\phi(n)=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})\ldots(1-\frac{1}{p_r})
$$
这就是欧拉函数的通用公式。</p>
<h3 id="欧拉定理">欧拉定理</h3>
<p>$$
a^{\phi(n)}\equiv1(mod\ n)
$$</p>
<p>欧拉定理的意思是 a 的$\phi(n)$次方被n除余数为1。</p>
<p>定理的证明十分复杂且超过本人能力，故暂不叙写证明。</p>
<h3 id="费马小定理">费马小定理</h3>
<p>著名的费马小定理其实是欧拉定理的一个特例。</p>
<p>假设正整数 a 与质数 p 互质，则欧拉定理可以写成
$$
a^{p-1}\equiv1(mod\ p)
$$</p>
<h3 id="模反元素">模反元素</h3>
<p>若两个正整数 a 和 n 互质，那么一定可以找到一个整数 b，使得 ab-1 能被 n 整除。换句话说即是 ab 被 n 除余数为 1。
$$
ab\equiv1(mod\ n)
$$
此时，我们称 b 为 a 的模反元素。</p>
<p>根据欧拉定理，我们很容易证明模反元素必然存在
$$
a^{\phi(n)}=a\times a^{\phi(n)-1}\equiv1(mod\ n)
$$
可见，a 的$\phi(n)-1$次方是 a 的模反元素。</p>
<h2 id="rsa算法">RSA算法</h2>
<p>RSA 算法实际上并不复杂</p>
<h3 id="参数">参数</h3>
<ol>
<li>
<p>随机选择两个不相等的质数 p 和 q</p>
<ul>
<li>p 和 q 越大，算法越难被破解</li>
</ul>
</li>
<li>
<p>计算 p 和 q 的乘积 n</p>
</li>
<li>
<p>计算 n 的欧拉函数$\phi(n)=(p-1)*(q-1)$</p>
</li>
<li>
<p>选择一个整数 e，其中$1</p>
<ul>
<li>现实生活中常取 e=65537=0x10001</li>
</ul>
</li>
<li>
<p>计算 e 对$\phi(n)$的模反元素 d</p>
<ul>
<li>
<p>$$
ed\equiv1(mod\ \phi(n))
$$
式子等价于
$$
ed-1=k\phi(n)
$$
取 x=d，y=-k
$$
ex+\phi(n)y=1
$$
用辗转相除法求解得一组整数解（x,y），从而得到 d</p>
</li>
<li>
<p>在 python 中可以直接调用 gmpy2 库中的<code>invert()</code>函数得到 d
具体用法为<code>d=gmpy2.invert(e,phi)</code></p>
</li>
</ul>
</li>
<li>
<p>算上明文 m 和密文 c，我们得到 RSA 算法的所有参数</p>
</li>
</ol>
<h3 id="加密解密">加密&amp;解密</h3>
<h4 id="使用公钥ne加密">使用公钥（n,e）加密</h4>
<p>对于明文 m，我们使用下列公式算出密文 c：
$$
m^e\equiv c(mod\ n)
$$
值得注意的是，m 必须是一个小于 n 的整数（字符串可以取 ASCII 值或 Unicode 值）。</p>
<h4 id="使用私钥nd解密">使用私钥（n,d）解密</h4>
<p>对于收到的密文 c，我们使用下列公式解出明文 m：
$$
c^d\equiv m(mod\ n)
$$
数学证明依旧暂不给出。</p>
<p>至此，我们完成了 RSA 算法的加密-解密过程。</p>
<h3 id="安全性">安全性</h3>
<p>由加密-解密过程可看出，若不知道密钥 d，则没有办法由密文 c 解得明文 m，而若想得到d就必须先分解 n，而我们知道大数的质因数分解极其困难，这也保证了现阶段 RSA 算法是安全的。</p>
<p>我们可以看见，RSA 算法在理论上并不是安全的。事实上，现在普遍认为量子计算机的发展很有可能使 RSA 算法变得极不安全。但至少在现阶段人类科技水平下 RSA 算法仍然非常安全。</p>
<h2 id="后记">后记</h2>
<ul>
<li><em>RSA 算法的 C 语言实现以及 RSA 算法及其相关定理的证明将在后几篇文章给出，敬请期待。</em></li>
</ul>
<h2 id="参考">参考</h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/48249182">RSA算法原理 - Sylarxx的文章 - 知乎</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html">RSA算法原理（一）- 阮一峰的网络日志</a></li>
<li><a href="https://www.bilibili.com/video/BV1Ts411H7u9">李永乐老师的视频</a></li>
</ul>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/ASUKA39" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 a39.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
